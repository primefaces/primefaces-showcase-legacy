<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="./template.xhtml">

    <ui:define name="head">
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
        <style type="text/css">
            .ui-outputlabel {
                margin: 10px 0px 0px 50px;
            }
            .ui-button {
                margin: 10px 0px 0px 20px;
            }
        </style>
        
        <script type="text/javascript">
            function myGeocode() {
                PF('geoMap').geocode(document.getElementById('address').value);
            }

            function myReverseGeocode() {
                var lat = document.getElementById('lat').value,
                    lng = document.getElementById('lng').value;

                PF('revGeoMap').reverseGeocode(lat, lng);
            }
        </script>
	</ui:define>
    
    <ui:define name="title">
        GMap - <span class="subitem">Geocode</span>
    </ui:define>

    <ui:define name="description">
        Google Maps API is used to find the coordinates of an address (Geocode) or an address with coordinates (Reverse Geocode).
    </ui:define>

    <ui:define name="implementation">

        <h:form prependId="false">
            <h3 style="margin-top:0">Geocode</h3>
            <p:gmap id="geoGmap" widgetVar="geoMap" center="38.9568857, 35.2408826" zoom="2" type="ROADMAP" model="#{geocodeView.simpleGeoModel}" style="width:600px;height:400px">
                <p:ajax event="geocode" listener="#{geocodeView.onGeocode}" update="geoGmap" />
            </p:gmap>

            <p:outputLabel for="address" value="Address:" />
            <p:inputText id="address" />
            <p:commandButton value="Submit" onclick="myGeocode()" type="button" />

            <h3>ReverseGeocode</h3>
            <p:gmap id="revGeoGmap" widgetVar="revGeoMap" center="38.9568857, 35.2408826" zoom="2" type="ROADMAP" model="#{geocodeView.simpleRevGeoModel}" style="width:600px;height:400px">
                <p:ajax event="reverseGeocode" listener="#{geocodeView.onReverseGeocode}" update="revGeoGmap" />
            </p:gmap>

            <p:outputLabel for="lat" value="Lat:" />
            <p:inputText id="lat" />
            <p:outputLabel for="lng" value="Lng:" />
            <p:inputText id="lng" />
            <p:commandButton value="Submit" onclick="myReverseGeocode()" type="button"/>
        </h:form>
        
    </ui:define>
 
    <ui:define name="source">
        <p:tabView>
            <p:tab title="geocode.xhtml">
                <pre name="code" class="brush:xml">
&lt;h:form prependId="false"&gt;
    &lt;h3 style="margin-top:0"&gt;Geocode&lt;/h3&gt;
    &lt;p:gmap id="geoGmap" widgetVar="geoMap" center="38.9568857, 35.2408826" zoom="2" type="ROADMAP" model="\#{geocodeView.simpleGeoModel}" style="width:600px;height:400px"&gt;
        &lt;p:ajax event="geocode" listener="\#{geocodeView.onGeocode}" update="geoGmap" /&gt;
        &lt;p:ajax event="reverseGeocode" listener="\#{geocodeView.onReverseGeocode}" update="revGeoGmap" /&gt;
    &lt;/p:gmap&gt;

    &lt;p:outputLabel for="address" value="Address:" /&gt;
    &lt;p:inputText id="address" /&gt;
    &lt;p:commandButton value="Submit" onclick="myGeocode()" type="button" /&gt;

    &lt;h3&gt;ReverseGeocode&lt;/h3&gt;
    &lt;p:gmap id="revGeoGmap" widgetVar="revGeoMap" center="38.9568857, 35.2408826" zoom="2" type="ROADMAP" model="\#{geocodeView.simpleRevGeoModel}" style="width:600px;height:400px"&gt;
        &lt;p:ajax event="reverseGeocode" listener="\#{geocodeView.onReverseGeocode}" update="revGeoGmap" /&gt;
    &lt;/p:gmap&gt;

    &lt;p:outputLabel for="lat" value="Lat:" /&gt;
    &lt;p:inputText id="lat" /&gt;
    &lt;p:outputLabel for="lng" value="Lng:" /&gt;
    &lt;p:inputText id="lng" /&gt;
    &lt;p:commandButton value="Submit" onclick="myReverseGeocode()" type="button"/&gt;
&lt;/h:form&gt;

&lt;script type="text/javascript"&gt;
    function myGeocode() {
        PF('geoMap').geocode(document.getElementById('address').value);
    }

    function myReverseGeocode() {
        var lat = document.getElementById('lat').value,
            lng = document.getElementById('lng').value;

        PF('revGeoMap').reverseGeocode(lat, lng);
    }
&lt;/script&gt;
                </pre>
            </p:tab>

            <p:tab title="GeocodeView.java">
                <pre name="code" class="brush:java">
package org.primefaces.showcase.view.data.gmap;

import java.util.List;
import javax.annotation.PostConstruct;
import javax.faces.bean.ManagedBean;
import org.primefaces.event.map.GeocodeEvent;
import org.primefaces.event.map.ReverseGeocodeEvent;
import org.primefaces.model.map.DefaultMapModel;
import org.primefaces.model.map.LatLng;
import org.primefaces.model.map.MapModel;
import org.primefaces.model.map.Marker;

@ManagedBean
public class GeocodeView {
    
    private MapModel simpleGeoModel;
    private MapModel simpleRevGeoModel;
    
    @PostConstruct
    public void init() {
        simpleGeoModel = new DefaultMapModel();
        simpleRevGeoModel = new DefaultMapModel();
    }
    
    public void onGeocode(GeocodeEvent event) {
        List&lt;LatLng&gt; latLng = event.getLatlng();
        for(int i = 0; i &lt; latLng.size(); i++) {
            LatLng coord = new LatLng(latLng.get(i).getLat(), latLng.get(i).getLng());
            simpleGeoModel.addOverlay(new Marker(coord, event.getAddress().get(0)));
        }
    }
    
    public void onReverseGeocode(ReverseGeocodeEvent event) {
        LatLng coord = new LatLng(event.getLatlng().get(0).getLat(), event.getLatlng().get(0).getLng());
        simpleRevGeoModel.addOverlay(new Marker(coord, event.getAddress().get(0)));
    }

    public MapModel getSimpleGeoModel() {
        return simpleGeoModel;
    }

    public MapModel getSimpleRevGeoModel() {
        return simpleRevGeoModel;
    }
    
}
                </pre>
            </p:tab>
            
        </p:tabView>

    </ui:define>

</ui:composition>
